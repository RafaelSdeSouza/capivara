% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_cluster_spectra.R
\name{plot_cluster_spectra}
\alias{plot_cluster_spectra}
\title{Visualize Scaled Spectra and Median Profiles for Clustered IFU Data}
\usage{
plot_cluster_spectra(
  cluster_result,
  scale_fn = median_scale,
  palette = "magma"
)
}
\arguments{
\item{cluster_result}{A list produced by a segmentation function (e.g. \code{\link{segment}})
containing at least the following elements:
\itemize{
  \item \code{cluster_map}: A matrix mapping each spatial pixel to a cluster.
  \item \code{original_cube}: The original data cube (typically a FITS object).
  \item \code{axDat}: Axis metadata (including wavelength information).
}}

\item{scale_fn}{A function that scales each individual spectrum (a numeric vector).
The default is \code{median_scale} which should be defined elsewhere in your package.}

\item{highlight_color}{A character string specifying the color for plotting the median spectrum.
Defaults to \code{"red3"}.}
}
\value{
A \code{ggplot2} object representing a faceted plot of the scaled individual spectra
  and their median profiles for each cluster.
}
\description{
This function creates a faceted plot that displays the individual pixel spectra (after
scaling) and the corresponding median spectrum for each segmented cluster obtained from
an IFU data cube. Each facet corresponds to a unique cluster, allowing for easy comparison
of spectral profiles across different spatial regions.
}
\details{
The function performs the following steps:
\enumerate{
  \item Extracts the spatial cluster map, original data cube, and wavelength information from
        \code{cluster_result}.
  \item Converts the cube to a 2D matrix (assuming \code{cube_to_matrix} is available).
  \item Creates a data frame mapping each valid spatial pixel to its cluster.
  \item Extracts each pixel's spectrum and applies the scaling function \code{scale_fn} to it.
  \item Computes the median spectrum for each cluster at every wavelength.
  \item Constructs a faceted ggplot where:
    \itemize{
      \item Gray lines represent the scaled individual spectra.
      \item A highlighted line (using \code{highlight_color}) represents the median spectrum.
    }
}
}
\examples{
\dontrun{
  # Assuming 'input_cube' is a FITS cube and 'segment' clusters the data:
  cluster_result <- segment(input_cube, Ncomp = 5)

  # Generate the spectra plot with scaling and a highlighted median spectrum
  spectra_plot <- plot_cluster_spectra(cluster_result, scale_fn = median_scale, highlight_color = "red3")
  print(spectra_plot)
}

}
\seealso{
\code{\link{segment}}, \code{\link{cube_to_matrix}}, \code{\link[FITSio]{axVec}}
}
