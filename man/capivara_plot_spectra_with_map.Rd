% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/capivara_plot_spectra.R,
%   R/capivara_plot_spectra_with_map.R
\name{capivara_plot_spectra_with_map}
\alias{capivara_plot_spectra_with_map}
\title{Plot Median Spectrum and Associated Spectra for a Bin}
\usage{
capivara_plot_spectra_with_map(
  cluster_result,
  bin_id,
  highlight_color = "#FFDE38",
  map_palette = "magma"
)

capivara_plot_spectra_with_map(
  cluster_result,
  bin_id,
  highlight_color = "#FFDE38",
  map_palette = "magma"
)
}
\arguments{
\item{cluster_result}{A list containing the results from the Capivara clustering process.
Must include the following elements:
\itemize{
  \item \code{cluster_map}: A 2D matrix mapping each pixel to a cluster.
  \item \code{original_cube}: The original 3D data cube (e.g., IFU data).
  \item \code{axDat}: Metadata for the data cube axes, including wavelength information.
}}

\item{bin_id}{An integer specifying the ID of the bin to be visualized.}

\item{highlight_color}{A character string specifying the color for the median spectrum
line in the plot (default: \code{"#FFDE38"}).}

\item{map_palette}{A character string specifying the color palette for the 2D map
visualization (default: \code{"magma"}).}
}
\value{
A \code{ggplot2} object representing the plot.

A list containing two \code{ggplot2} objects:
  \itemize{
    \item \code{spectrum_plot}: The spectrum visualization.
    \item \code{cluster_plot}: The 2D map visualization.
  }
}
\description{
This function visualizes the median spectrum and all associated spectra for a given bin
from the output of the Capivara clustering process. It overlays the median spectrum
on the plot of all individual spectra for the bin.

This function visualizes the median spectrum and all associated spectra for a given bin
from the output of the Capivara clustering process. Additionally, it generates a 2D spatial
map highlighting the specified bin in color while leaving all other regions white.
}
\details{
The function extracts the spectra for all pixels in the specified bin, computes the median spectrum,
and creates a plot where:
\itemize{
  \item Gray lines represent individual spectra for all pixels in the bin.
  \item The highlighted line represents the median spectrum.
}
The plot is returned as a \code{ggplot2} object for further customization or saving.

The function performs the following tasks:
\itemize{
  \item Extracts the spectra for all pixels belonging to the specified bin.
  \item Computes the median spectrum for the bin.
  \item Creates a plot where:
    \itemize{
      \item Gray lines represent individual spectra for all pixels in the bin.
      \item The highlighted line represents the median spectrum.
    }
  \item Generates a 2D spatial map where:
    \itemize{
      \item The specified bin is highlighted in color.
      \item All other regions are displayed in white.
    }
}

Both the spectrum plot and the spatial map are returned as \code{ggplot2} objects
for further customization or saving.
}
\examples{
# Example usage
cluster_result <- list(
  cluster_map = matrix(sample(1:3, 100, replace = TRUE), nrow = 10),
  original_cube = list(imDat = array(runif(1000), dim = c(10, 10, 10))),
  axDat = list(c(1:10, 1:10, seq(4000, 7000, length.out = 10)))
)

plot <- capivara_plot_spectra(cluster_result, bin_id = 1)
print(plot)

# Example usage
cluster_result <- list(
  cluster_map = matrix(sample(1:3, 100, replace = TRUE), nrow = 10),
  original_cube = list(imDat = array(runif(1000), dim = c(10, 10, 10))),
  axDat = list(c(1:10, 1:10, seq(4000, 7000, length.out = 10)))
)

result <- capivara_plot_spectra_with_map(cluster_result, bin_id = 1)
print(result$spectra_plot)  # Plot the spectrum
print(result$cluster_plot)  # Plot the 2D map

}
